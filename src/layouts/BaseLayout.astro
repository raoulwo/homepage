---
import "../styles/global.css";
import Navigation from "../components/navigation/Navigation.astro";
import Footer from "../components/Footer.astro";
import ContactSection from "../components/ContactSection.astro";
import { ClientRouter } from "astro:transitions";
---

<html
  lang="en"
  class="no-scrollbar"
  transition:name="root"
  transition:animate="fade"
>
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <title>raoulwo</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Assistant:wght@200..800&family=Rubik:ital,wght@0,300..900;1,300..900&display=swap"
      rel="stylesheet"
    />
    <ClientRouter />
  </head>
  <body class="font-assistant flex min-h-screen flex-col">
    <Navigation />
    <main class="flex flex-1">
      <slot />
    </main>
    <ContactSection />
    <Footer />
    <script>
      function setupObserver() {
        console.log("Checking for reveal elements...");
        const revealElements = document.querySelectorAll(".reveal");

        if (revealElements.length === 0) {
          console.warn("No elements with class '.reveal' found in the DOM.");
          return;
        }

        console.log(
          `Found ${revealElements.length} elements. Starting Observer.`,
        );

        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                console.log("Element visible! Animating:", entry.target);
                entry.target.classList.remove("opacity-0", "translate-y-8");
                entry.target.classList.add("opacity-100", "translate-y-0");
                observer.unobserve(entry.target);
              }
            });
          },
          { threshold: 0.1 },
        );

        revealElements.forEach((el) => observer.observe(el));
      }

      // Run on initial load
      setupObserver();

      // Re-run if using ViewTransitions
      document.addEventListener("astro:after-swap", setupObserver);
      // Alternative for different Astro versions
      document.addEventListener("astro:page-load", setupObserver);
    </script>
  </body>
</html>
